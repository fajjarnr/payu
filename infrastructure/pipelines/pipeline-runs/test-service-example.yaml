apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  name: account-service-test-$(TIMESTAMP)
  namespace: payu-cicd
  labels:
    app: payu
    service: account-service
    type: test
spec:
  pipelineRef:
    name: payu-test-pipeline
  params:
    - name: service-name
      value: account-service
    - name: git-url
      value: https://github.com/payu-digital/payu-platform.git
    - name: git-revision
      value: main
    - name: service-type
      value: spring-boot
    - name: coverage-threshold
      value: "80"
    - name: run-integration-tests
      value: "true"
  workspaces:
    - name: source
      persistentVolumeClaim:
        claimName: tekton-workspace-pvc
      subPath: source
    - name: maven-settings
      configMap:
        name: maven-settings
    - name: sonarqube-settings
      secret:
        secretName: sonarqube-credentials
  timeout: 2h
