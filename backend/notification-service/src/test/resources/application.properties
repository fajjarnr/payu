# Test Configuration for Notification Service
#
# Docker Requirements:
# - Unit tests (Architecture tests, SimpleTest): No Docker required
# - Integration tests (@QuarkusTest tests): Require Docker for Kafka DevServices
#
# Run tests with Docker (enables all tests including integration tests):
#   mvn test -Ddocker.enabled=true
# Run unit tests only (no Docker required):
#   mvn test
#
# Note: Integration tests are annotated with @EnabledIfSystemProperty and will be
# skipped when docker.enabled system property is not set to "true"

# Use H2 in-memory database for unit tests (no Docker required)
quarkus.datasource.db-kind=h2
quarkus.datasource.jdbc.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=PostgreSQL;IGNORE_UNKNOWN_SETTINGS=TRUE
quarkus.datasource.username=sa
quarkus.datasource.password=

# Configure Hibernate ORM packages (required at build time)
quarkus.hibernate-orm.packages=id.payu.notification.domain
quarkus.hibernate-orm.database.generation=drop-and-create
quarkus.hibernate-orm.database.dialect=org.hibernate.dialect.H2Dialect

# Disable Kafka DevServices for tests - use In-Memory connector instead
quarkus.kafka.devservices.enabled=false

# Mock mailer for tests
quarkus.mailer.mock=true

# Disable OpenTelemetry in tests
quarkus.opentelemetry.enabled=false

# Reactive Messaging: Use In-Memory connector to avoid Kafka dependency/errors in tests
mp.messaging.incoming.wallet-events.connector=smallrye-in-memory
mp.messaging.incoming.transaction-events.connector=smallrye-in-memory
mp.messaging.incoming.payment-events.connector=smallrye-in-memory
